<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>Threejs Viewcube Navigation Control</title>
  <script src="../vendor/jquery/dist/jquery.min.js"></script>
  <script src="../vendor/mousetrap/mousetrap.min.js"></script>
  <script src="../vendor/three.js/three.min.js"></script>
  <script src="../vendor/tween.js/build/tween.min.js"></script>
  <script src="../lib/controls/TrackballController.js"></script>
  <script src="../lib/path/PathPlanner.js"></script>
  <script src="../lib/TargetCamera.js"></script>
  <script src="../lib/Viewcube.js"></script>
  <script src="../lib/Viewport3D.js"></script>
  <style>
    body {
      background: #444;
      margin:0;
      padding:0;
    }
    #viewcube {
      background-color: transparent;
      border: 1px solid rgba(255,0,0,0.5);
      height: 200px;
      overflow: hidden;
      position: absolute;
      right: 0;
      top: 0;
      width: 200px;
      z-index: 500;
    }
    #viewport {
      bottom: 0;
      left: 0;
      overflow: hidden;
      position: absolute;
      right: 0;
      top: 0;
    }
  </style>
</head>
<body>
<div id="viewport"></div>
<div id="viewcube"></div>
<script>
  $(document).ready(function () {
    var domElement = document.getElementById('viewport');
    var scene = new THREE.Scene();

    // camera
    var camera = new FOUR.TargetCamera(50, domElement.clientWidth / domElement.clientHeight, 0.1, 1000);
    camera.position.set(50,50,50);
    camera.up = new THREE.Vector3(0,0,1);
    scene.add(camera);

    // lights
    var ambientLight = new THREE.AmbientLight(0x000000);
    scene.add(ambientLight);

    var lights = [];
    lights[0] = new THREE.PointLight(0xffffff, 1, 0);
    lights[1] = new THREE.PointLight(0xffffff, 1, 0);
    lights[2] = new THREE.PointLight(0xffffff, 1, 0);

    lights[0].position.set(0, 200, 0);
    lights[1].position.set(100, 200, 100);
    lights[2].position.set(-100, -200, -100);

    scene.add(lights[0]);
    scene.add(lights[1]);
    scene.add(lights[2]);

    // add some geometry for demonstration purposes
    var count = 1000, cloud = new THREE.Object3D();
    var geometry, material = new THREE.MeshPhongMaterial({
      color: 0x156289,
      emissive: 0x072534,
      side: THREE.DoubleSide,
      shading: THREE.FlatShading
    }), mesh;
    for (var i =0;i<count;i++) {
      geometry = new THREE.BoxGeometry(1,1,1);
      mesh = new THREE.Mesh(geometry, material);
      mesh.position.x = Math.floor(Math.random() * 100);
      mesh.position.y = Math.floor(Math.random() * 100);
      mesh.position.z = Math.floor(Math.random() * 100);
      cloud.add(mesh);
    }
    cloud.position.set(-50,-50,-50);
    scene.add(cloud);

    var axisHelper = new THREE.AxisHelper(50);
    scene.add(axisHelper);

    var viewport = new FOUR.Viewport3D({camera:camera, domElement:domElement, scene:scene});
    var trackball = new FOUR.TrackballController({viewport:viewport});
    viewport.addController(trackball, 'trackball');
    viewport.setActiveController('trackball');

    // viewcube
    var viewcubeElement = document.getElementById('viewcube');
    var viewcube = window.viewcube = new FOUR.Viewcube({domElement:viewcubeElement, enable: {compass:false, cube:true}, viewport:viewport});

    viewport.addEventListener('update', viewcube.onCameraUpdate.bind(viewcube), false);

    viewport.update();
    viewport.render();

    viewcube.update();
    viewcube.render();

  });
</script>
</body>
</html>