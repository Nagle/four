<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>FOUR - Pan Controller</title>
  <!-- vendor -->
  <script src="../../vendor/jquery/dist/jquery.js"></script>
  <script src="../../vendor/mousetrap/mousetrap.js"></script>
  <script src="../../vendor/three.js/three.min.js"></script>
  <script src="../../vendor/tween.js/src/Tween.js"></script>

  <!-- lib -->
  <script src="../../lib/controls/MultiController.js"></script>
  <script src="../../lib/controls/PanController.js"></script>
  <script src="../../lib/controls/RotateController.js"></script>
  <script src="../../lib/controls/TrackballController.js"></script>
  <script src="../../lib/controls/ZoomController.js"></script>
  <script src="../../lib/path/PathPlanner.js"></script>
  <script src="../../lib/Scene.js"></script>
  <script src="../../lib/TargetCamera.js"></script>
  <script src="../../lib/Viewport3D.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
    }

    #webgl {
      bottom: 0;
      left: 0;
      overflow: hidden;
      position: absolute;
      right: 0;
      top: 0;
      z-index: 500;
    }

    #webgl:focus {
      outline: none;
    }
  </style>
</head>
<body>
<div id="webgl"></div>
<script>
  $(document).ready(function () {
    var camera, controller, domElement, geometry, helper, i, light, material, mesh, scene, viewport;

    // scene
    scene = new FOUR.Scene();

    // camera
//        camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000);
    camera = new FOUR.TargetCamera(60, window.innerWidth / window.innerHeight, 1, 1000);
    camera.position.y = -100;
    scene.cameras.add(camera);

    // lights
    light = new THREE.DirectionalLight(0xffffff);
    light.position.set(1, 1, 1);
    scene.lights.add(light);

    light = new THREE.DirectionalLight(0x002288);
    light.position.set(-1, -1, -1);
    scene.lights.add(light);

    light = new THREE.AmbientLight(0x222222);
    scene.lights.add(light);

    helper = new THREE.AxisHelper(10);
    scene.helpers.add(helper);

    // world
    geometry = new THREE.CylinderGeometry(0, 10, 30, 4, 1);
    material = new THREE.MeshPhongMaterial({color: 0xffffff, shading: THREE.FlatShading});
    for (i = 0; i < 500; i++) {
      mesh = new THREE.Mesh(geometry, material);
      mesh.position.x = (Math.random() - 0.5) * 1000;
      mesh.position.y = (Math.random() - 0.5) * 1000;
      mesh.position.z = (Math.random() - 0.5) * 1000;
      mesh.updateMatrix();
      mesh.matrixAutoUpdate = false;
      scene.add(mesh);
    }

    // viewport
    domElement = document.getElementById('webgl');
    viewport = new FOUR.Viewport3D({camera: camera, continuousUpdate: true, domElement: domElement, scene: scene});

    window.addEventListener('mousemove', viewport.render.bind(viewport));

    // controllers
    var pan = new FOUR.PanController({viewport: viewport});
    var rotate = new FOUR.RotateController({viewport: viewport});
    var zoom = new FOUR.ZoomController({viewport: viewport});
    var trackball = new FOUR.TrackballController({viewport: viewport});

    var pan1 = new FOUR.PanController({viewport: viewport});
    var rotate1 = new FOUR.RotateController({viewport: viewport});
    var zoom1 = new FOUR.ZoomController({viewport: viewport});
    var multi = new FOUR.MultiController({viewport: viewport});
    multi.addController(pan1, 'pan');
    multi.addController(rotate1, 'rotate');
    multi.addController(zoom1, 'zoom');

    viewport.addController(pan, 'pan');
    viewport.addController(rotate, 'rotate');
    viewport.addController(zoom, 'zoom');
    viewport.addController(trackball, 'trackball');
    viewport.addController(multi, 'multi');

    Mousetrap.bind('1', function () {
      viewport.setActiveController('pan');
    });
    Mousetrap.bind('2', function () {
      viewport.setActiveController('rotate');
    });
    Mousetrap.bind('3', function () {
      viewport.setActiveController('zoom');
    });
    Mousetrap.bind('4', function () {
      viewport.setActiveController('trackball');
    });
    Mousetrap.bind('5', function () {
      viewport.setActiveController('multi');
    });

    viewport.render();
    viewport.update();

  });
</script>
</body>
</html>
